<div class="row" id="bring_form_result">
    <h1>{{ bring_form_result }}</h1>
    {% include "sender_list.html" %}
</div>
<script type="text/javascript">
function item_data(index) {
    return $.map(table.rows('.info').data(), function (item) {
        return Number(item[index])
    });
}

var parcel_ids = [];

$('#bring_table tbody').on( 'click', 'tr', function () {
    var n_rows = table.rows('.info').data().length;
    if (n_rows > 0) {

        parcel_ids = item_data(0);

        var total_weight = 0, total_price = 0;
        $.each(item_data(4), function() {
            total_weight += this;
        });
        $.each(item_data(5), function() {
            total_price += this;
        });

        $('.bring_total_box').show();
        $('.bring_total_box #total_weight').html(total_weight);
        $('.bring_total_box #total_price').html(total_price);
    }
    else {
        $('.bring_total_box').hide();
    }
} );

$('.bring_total_box').on('click', '#bring_button', function () {
    $.post("bring_submit/", { 'csrfmiddlewaretoken': '{{ csrf_token }}', 'parcel_ids': parcel_ids }).done(function( data ) {
        if (data == 'success') {
            $('#bring_form_result #success_text').show();
            setTimeout(function() {
                location.reload();
            }, 3000);
        }
        else if (data == 'not_logged') {
            $('#mainModal').modal('show');
        }
        else {

        }
    });
});

</script>